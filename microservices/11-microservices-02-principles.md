# Домашнее задание к занятию "11.02 Микросервисы: принципы"

Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.

## Задача 1: API Gateway 

> Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.
> 
> Решение должно соответствовать следующим требованиям:
> - Маршрутизация запросов к нужному сервису на основе конфигурации
> - Возможность проверки аутентификационной информации в запросах
> - Обеспечение терминации HTTPS
> 
> Обоснуйте свой выбор.


| Решение | Маршрутизация | Аутентификация | Терминация HTTPS | Бесплатно/Открыто? |
|---|---|---|---|---|
| Kong | + | + | + | Открыто, Apache 2.0 |
| Tyk.io | + | + | + | Открыто, MPL |
| Apache APISIX | + | + | + | Открыто, Apache 2.0 |
| APIGee | + | + | + | Платно |
| Amazon AWS API Gateway | + | + | - | Платно |
| Azure API Gateway | + | + | + | Платно |
| NGINX Plus | + | + | + | Платно |
| KrakenD | + | + | + | Двойное лицензирование, нужные нам функции частично в платной версии |

С точки зрения функциональных возможностей, для решения поставленной задачи подойдет любое решение из описанных выше, кроме разве что Amazon AWS API Gateway, т.к. для терминации HTTPS трафика от Backend требуется наличие самоподписанного SSL-сертификата.

Оптимальным решением в данном случае будет Kong, т.к. это очень популярное opensource решение. Данное решение построено на основе надежных технологий, таких как NGINX, и предоставляет легкий в использовании API RESTful для работы и настройки системы.


## Задача 2: Брокер сообщений

> Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.
> 
> Решение должно соответствовать следующим требованиям:
> - Поддержка кластеризации для обеспечения надежности
> - Хранение сообщений на диске в процессе доставки
> - Высокая скорость работы
> - Поддержка различных форматов сообщений
> - Разделение прав доступа к различным потокам сообщений
> - Простота эксплуатации
> 
> Обоснуйте свой выбор.

| Параметр | RabbitMQ | Apache Kafka | ActiveMQ | NATS | Redis |
|:---|:---:|:---:|:---:|:---:|:---:|
| Поддержка кластеризации для обеспечения надежности | + | + | + | + | + |
| Хранение сообщений на диске в процессе доставки | + | + | + | + | + |
| Высокая скорость работы | +- | + | - | + | + |
| Поддержка различных форматов сообщений | AMQP, MQTT, STOMP | Только binary через TCP Socket | 10 форматов, включая AMQP, AUTO, MQTT, REST | Только NATS Streaming Protocol | Только RESP |
| Разделение прав доступа к различным потокам сообщений | + | + | + | + | + |
| Простота эксплуатации | + | - | + | + | + |

Из описания задания не до конца понятен уровень нагрузки:
- Размер компании не коррелирует с большим объемом передаваемых сообщений, которые брокер будет обрабатывать. Если не брать в расчет данное замечание, то стоит рассмотреть RabbitMQ, так как данное решение очень пополурно, просто в экспулуатции и не требует сложной настройки. В случае больших нагрузок предлагаю Apache Kafka.
- В данном случае поддержка различных форматов необходимость или требование с заделом на будущее

В качестве универсального решения - RabbitMQ. Он является "швейцарским ножом" в данном случае. Так как решение является очень пополурным, то не составит труда найти или обучить специалиста для его обсуживания.
Если брокер нужен только для взяимодействия между микросервисами, тогда NATS, так как данное решение специально разработана для решения подобных задач.